{% extends 'base/base.html' %}
{% load static %}

{% block title %}Ежедневник{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{% static 'tasks/css/task-form.css' %}">
<link rel="stylesheet" href="{% static 'tasks/css/side-menu.css' %}">
<link rel="stylesheet" href="{% static 'tasks/css/week.css' %}">
{% endblock %}

{% block content %}
<div class="main-area">
    <div class="side_left_menu">
        <div class = "user">

            <h3>Профиль</h3>
        </div>
        <button class = "btn_left"><a href="{% url 'my_tasks' %}">Мои задачи</a></button>
        <div class="folders">
            <p>Папки</p>
            <ul><!--Здесь должны отображаться папки, пока не доделано--></ul>
        </div>
    </div>
    <div class = "task_area">
        <div class ="search-container">
            <input type="text" placeholder="Найти задачу..." class="search-input">
            <div class="filter-container">
                <label for="filterSelect">Фильтр:</label>
                <select id="filterSelect" class="filter-select">
                    <option value="">Выберите фильтр</option>
                    <option value="status">Статус</option>
                    <option value="priority">Приоритет</option>
                    <option value="tag">Тег</option>
                </select>
            </div>
            <div class="notification-container">
                <img src="../../static/tasks/img/bell-alarm.svg" alt="Уведомления" class="notification-icon" onclick="toggleNotifications()">
                <div class="notification-badge" id="notificationBadge"></div>
                <div id="notificationPopup" class="notification-popup" style="display: none;">
                 </div>
            </div>
        </div>

        <div class="week-view">
            <h2>Задачи</h2>
            <div class = "calendar-container">
                <button id="prevDays" onclick="changeDays(-4)">&#9664;</button> 
                <div class="calendar" id="calendar">
                    {% for date, tasks in grouped_tasks.items %}
                        <div class="day" id="day1">
                            <p class="day-name"></p>
                            <p class="date">{{ date }}</p>
                            <button class="add-task-btn" onclick="openForm()">Добавить задачу</button>
                            <div class="tasks-container">
                                {% for task in tasks %}
                                    <div class="my_task_area">{{ task.title }} - {{ task.deadline }}</div>
                                {% endfor %}
                            </div>
                        </div>
                    {% endfor %}
                </div>
                <button id="nextDays" onclick="changeDays(4)">&#9654;</button> 
            </div>
        </div>
        <div class="task">
            <div class="hidden" id="TaskForm"> 
                {% csrf_token %}
                <div class="task-status">
                    <input type="checkbox" id="taskCompleted">
                    <label for="taskCompleted">Выполнено</label>
                    <button class="start-timer">Старт</button>
                </div>
                <input type="text" placeholder="Название задачи" id="taskName">
                <p>Крайний срок выполнения задачи</p>
                <input type="date" id="taskDate">
                <div class="priority">
                <p class="priority-text"> Приоритет задачи</p>
                <select id="taskPriority" class="task-priority">
                    <option value=3>Низкий</option>
                    <option value=2>Средний</option>
                    <option value=1>Высокий</option>
                </select>
                </div>
                <textarea placeholder="Заметка" id = "taskFullText"></textarea>
                <div>
                    <button id="chooseFolderBtn" type="button">Выберите папку</button>
                    <ul id="foldersList" style="display: none; position: absolute; list-style: none; padding: 0; margin: 0;">
                    </ul>
                </div>
                <select id="taskFolder" style="display: none;">
                    <option value="">Выберите папку</option>
                </select>
                <div class="subtask-container">
                    <div class="subtask">
                        <input type="text" placeholder="Подзадача">
                    </div>
                </div>
                <div class="button-subtask-container">
                    <button id="addSubtask">+</button> 
                    <button id="removeSubtask">-</button> 
                </div>

                <div class = "save-btn-container">
                    <button id = "SaveTask">Сохранить</button>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{% static 'tasks/js/open_task_form.js' %}"></script>
<script src="{% static 'tasks/js/subtask.js' %}"></script>
<script src="{% static 'tasks/js/calendar.js' %}"></script>
<script src="{% static 'tasks/js/remind_task.js' %}"></script>


{% endblock %}
